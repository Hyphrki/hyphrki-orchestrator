apiVersion: v1
kind: Namespace
metadata:
  name: orchestrator-system
  labels:
    name: orchestrator-system
    app.kubernetes.io/name: orchestrator
    app.kubernetes.io/component: system
---
apiVersion: v1
kind: Namespace
metadata:
  name: orchestrator-frameworks
  labels:
    name: orchestrator-frameworks
    app.kubernetes.io/name: orchestrator
    app.kubernetes.io/component: frameworks
---
apiVersion: v1
kind: Namespace
metadata:
  name: orchestrator-monitoring
  labels:
    name: orchestrator-monitoring
    app.kubernetes.io/name: orchestrator
    app.kubernetes.io/component: monitoring
---
apiVersion: v1
kind: Namespace
metadata:
  name: orchestrator-tenants
  labels:
    name: orchestrator-tenants
    app.kubernetes.io/name: orchestrator
    app.kubernetes.io/component: tenants
---
# Network policies for multi-tenant isolation
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: deny-all
  namespace: orchestrator-tenants
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-backend-access
  namespace: orchestrator-tenants
spec:
  podSelector:
    matchLabels:
      component: tenant-app
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          app.kubernetes.io/component: system
    ports:
    - protocol: TCP
      port: 80
    - protocol: TCP
      port: 443
  egress:
  - to:
    - namespaceSelector:
        matchLabels:
          app.kubernetes.io/component: system
    ports:
    - protocol: TCP
      port: 80
    - protocol: TCP
      port: 443
  - to:
    - namespaceSelector:
        matchLabels:
          app.kubernetes.io/component: frameworks
    ports:
    - protocol: TCP
      port: 8001
    - protocol: TCP
      port: 8002
    - protocol: TCP
      port: 8003
    - protocol: TCP
      port: 8004
